{
  "kind": "build_request",
  "title": "Fix authentication error when user is already authenticated on Admin Dashboard",
  "projectName": "AC Buy",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-47",
      "text": "Fix the Admin Dashboard authentication logic in frontend/src/components/Layout.tsx to check if the user is already authenticated before calling login(). If the user is already authenticated, navigate directly to /admin without triggering a new authentication flow.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "It's telling authentication failed user allready authenticated"
        ]
      },
      "acceptanceCriteria": [
        "When an authenticated user clicks the Admin Dashboard button, they are immediately navigated to /admin without triggering a login dialog",
        "The 'authentication failed user already authenticated' error no longer appears",
        "Unauthenticated users still see the login dialog when clicking Admin Dashboard",
        "Console logs show the authentication status is properly checked before calling login()"
      ]
    },
    {
      "id": "REQ-48",
      "text": "Update the Admin Dashboard click handler in frontend/src/components/Layout.tsx to add a conditional check: if isAuthenticated is true, skip the login() call and navigate directly to /admin using navigate('/admin').",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "It's telling authentication failed user allready authenticated"
        ]
      },
      "acceptanceCriteria": [
        "The handleAdminClick function checks the isAuthenticated state before attempting login",
        "When isAuthenticated is true, the function immediately calls navigate('/admin')",
        "When isAuthenticated is false, the function calls login() as before",
        "The authentication status check is logged to the console for debugging"
      ]
    },
    {
      "id": "REQ-49",
      "text": "Add error handling in the Admin Dashboard click handler to catch and display a user-friendly error message when the authentication system detects that a user is already authenticated but login() is called anyway.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "It's telling authentication failed user allready authenticated"
        ]
      },
      "acceptanceCriteria": [
        "If login() throws an error indicating the user is already authenticated, the error is caught and logged",
        "A user-friendly toast notification or error message is displayed explaining the situation",
        "The user is still navigated to /admin despite the error",
        "The error does not prevent access to the admin dashboard"
      ]
    }
  ],
  "constraints": [
    "Do not modify the Internet Identity authentication implementation in frontend/src/hooks/useInternetIdentity.ts",
    "Preserve the existing logout functionality",
    "Do not change the backend authentication logic"
  ],
  "nonGoals": [
    "Changing the Internet Identity provider configuration",
    "Modifying the authentication state management system",
    "Adding new authentication methods or providers"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}